---
  - name: "Create and join Ciphertrust Manager Role"
    hosts: localhost
    connection: local 

    vars_files:
      - variables.yaml

    tasks:
    #Skip this task if there is already a cluster with at least one member
    - name: "Create new cluster"
      thales.ciphertrust.cm_cluster_new:
        localNode: "{{ this_node_connection_string }}"
      register: output
#
#    - name: "Join nodes to the cluster"
#      thales.ciphertrust.cm_cluster_join:
#        localNode: "{{ this_node_connection_string }}"
#        newNodes: "{{ cluster_nodes }}"
#      register: output

    - name: Debug Output
      debug: var=output

